{"ast":null,"code":"import axios from 'axios';\nconst initialState = {\n  client: [{\n    _id: '',\n    titre: '',\n    description: '',\n    prix: '',\n    date: '',\n    debut: '',\n    duree: '',\n    reserve: '',\n    disponible: '',\n    image: '',\n    active: '',\n    utilisateur: ''\n  }]\n};\n\nfunction connexion(state = initialState, action) {\n  let nextState = [0];\n\n  switch (action.type) {\n    //postAdmin 8080\n    case 'REGISTER':\n      console.log(\"action: \", action.value);\n      axios.post('https://tsiorytahback.herokuapp.com/register', action.value) // axios.post('http://localhost:8080/register/', action.value)\n      .then(response => {\n        console.log(\"post action: \", action.value);\n        console.log(\"post ok: res.data \", response.data);\n        localStorage.setItem('id', parseInt(response.data._id));\n        localStorage.setItem('user', response.data.nom);\n        localStorage.setItem('login', 'true');\n        console.log('reducer REGISTER: ', localStorage.getItem('login'));\n      }).catch(error => {\n        console.log(\"erreur be: \", error);\n      });\n      break;\n\n    case 'EDIT_PROFIL':\n      console.log(\"action: \", action.value);\n      axios.put('https://tsiorytahback.herokuapp.com/register/' + localStorage.getItem('id'), action.value) // axios.put(\"http://localhost:8080/register/\" + localStorage.getItem('id'), action.value)\n      .then(response => {\n        console.log(\"put ok: res.data \", response.data);\n        localStorage.setItem('user', response.data[localStorage.getItem('id')].nom);\n        console.log('reducer EDIT: ', localStorage.getItem('login'));\n      }).catch(error => {\n        console.log(\"erreur be: \", error);\n      });\n      break;\n\n    case 'DELETE_PROFIL':\n      console.log(\"action: \", action.value);\n      axios.delete('https://tsiorytahback.herokuapp.com/register/' + localStorage.getItem('id'), action.value) // axios.put(\"http://localhost:8080/register/\" + localStorage.getItem('id'), action.value)\n      .then(response => {\n        console.log(\"delete ok: res.data \", response.data);\n        localStorage.setItem('id', 'none');\n        localStorage.setItem('user', 'none');\n      }).catch(error => {\n        console.log(\"erreur be: \", error);\n      });\n      break;\n    //postLogin 8080\n\n    case 'LOGIN':\n      console.log(\"action: \", action.value);\n      axios.post('https://tsiorytahback.herokuapp.com/login/', action.value) // axios.post('http://localhost:8080/login', action.value)\n      .then(response => {\n        if (response.data.nom == action.value.nom) {\n          localStorage.setItem('id', response.data._id);\n          localStorage.setItem('user', response.data.nom);\n          localStorage.setItem('login', 'true');\n          console.log('TSIORY response: ', response.data);\n        }\n\n        console.log(\"post ok: res.data \", response);\n      }).catch(error => {\n        console.log(\"erreur be: \", error);\n      });\n      break;\n\n    case 'DECONNECT':\n      localStorage.setItem('id', 'none');\n      localStorage.setItem('user', 'none');\n      localStorage.setItem('login', 'false');\n      break;\n\n    case 'GETARTICLE':\n      axios.get('https://tsiorytahback.herokuapp.com/profil') // axios.get('http://localhost:8080/')\n      .then(function (response) {\n        nextState = response.data;\n        console.log(\"ttt\", nextState);\n        return nextState;\n      }).catch(function (error) {\n        console.log(error);\n      });\n      break;\n\n    case 'UPDATE_ARTICLE':\n      console.log(\"action update: \", action.value);\n      axios.put('https://tsiorytahback.herokuapp.com/profil', action.value) // axios.put('http://localhost:8080/profil/', action.value)\n      .then(response => {\n        console.log(\"put action: \", action.value);\n        console.log(\"put ok: res.data \", response.data);\n        console.log('reducer PUT: ', localStorage.getItem('login'));\n      }).catch(error => {\n        console.log(\"put action: \", action.value);\n        console.log(\"erreur be: \", error);\n      });\n      break;\n\n    case 'DELETE_ARTICLE':\n      console.log(\"action: \", action.value);\n      axios.delete('https://tsiorytahback.herokuapp.com/profil/' + action.value._id, action.value) // axios.post('http://localhost:8080/register/', action.value)\n      .then(response => {\n        console.log(\"delete action: \", action.value);\n        console.log(\"delete ok: res.data \", response.data);\n        console.log('reducer DELETE: ', localStorage.getItem('login'));\n      }).catch(error => {\n        console.log(\"erreur be: \", error);\n      });\n      break;\n\n    case 'INSCRIRE':\n      console.log(\"action: \", action.value);\n      axios.post('https://tsiorytahback.herokuapp.com/particulier', action.value) // axios.post('http://localhost:8080/particulier/', action.value)\n      .then(response => {\n        console.log(\"post action: \", action.value);\n        console.log(\"post ok: res.data \", response.data); //DEBUT TEST\n\n        axios.get('https://tsiorytahback.herokuapp.com/profil/').then(res => {\n          for (let i = 0; i < res.data.length; i++) {\n            if (res.data[i]._id == localStorage.getItem('atelier')) {\n              this.setState({\n                _id: res.data[i]._id,\n                titre: res.data[i].titre,\n                description: res.data[i].description,\n                prix: res.data[i].prix,\n                date: res.data[i].date,\n                debut: res.data[i].debut,\n                duree: res.data[i].duree,\n                reserve: res.data[i].reserve,\n                disponible: disponible,\n                image: res.data[i].image,\n                active: res.data[i].active,\n                utilisateur: res.data[i].utilisateur\n              });\n            }\n          }\n        });\n        const data = new FormData();\n        data.append('image', this.state.image);\n        data.append('titre', this.state.titre);\n        data.append('description', this.state.description);\n        data.append('prix', this.state.prix);\n        data.append('utilisateur', localStorage.getItem('id'));\n        data.append('date', this.state.date);\n        data.append('duree', this.state.duree);\n        data.append('debut', this.state.debut);\n        data.append('reserve', parseInt(this.state.reserve) + 1);\n        data.append('disponible', this.state.disponible);\n        data.append('active', true);\n        console.log('local atelier', localStorage.getItem('atelier'));\n        fetch('https://tsiorytahback.herokuapp.com/profil/' + localStorage.getItem('atelier'), {\n          // fetch('http://localhost:8080/profil', {\n          method: 'PUT',\n          body: data\n        }).then(response => {\n          response.json().then(body => {\n            console.log('body: ', body);\n            this.setState({\n              // image: `http://localhost:8080/profil/${body.image}`,\n              image: \"https://tsiorytahback.herokuapp.com/profil/\".concat(body.titre) + localStorage.getItem('atelier') + '.jpg'\n            });\n          });\n        }); //FIN TEST\n      }).catch(error => {\n        console.log(\"erreur be: \", error);\n      });\n      break;\n\n    default:\n      return state;\n  }\n}\n\nexport default connexion;","map":{"version":3,"sources":["/home/dev/Bureau/EXAMEN/testSIMPLON_front/src/store/reducer/reducer_admin.js"],"names":["axios","initialState","client","_id","titre","description","prix","date","debut","duree","reserve","disponible","image","active","utilisateur","connexion","state","action","nextState","type","console","log","value","post","then","response","data","localStorage","setItem","parseInt","nom","getItem","catch","error","put","delete","get","res","i","length","setState","FormData","append","fetch","method","body","json"],"mappings":"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","sourcesContent":["import axios from 'axios'\n\nconst initialState = {\n  client: [{\n    _id: '',\n    titre: '',\n    description: '',\n    prix: '',\n    date: '',\n    debut: '',\n    duree: '',\n    reserve: '',\n    disponible: '',\n    image: '',\n    active: '',\n    utilisateur: ''\n  }]\n}\n\nfunction connexion(state = initialState, action) {\n  let nextState = [0]\n  switch (action.type) {\n\n    //postAdmin 8080\n    case 'REGISTER':\n      console.log(\"action: \", action.value);\n      axios.post('https://tsiorytahback.herokuapp.com/register', action.value)\n        // axios.post('http://localhost:8080/register/', action.value)\n        .then((response) => {\n          console.log(\"post action: \", action.value);\n          console.log(\"post ok: res.data \", response.data);\n          localStorage.setItem('id', parseInt(response.data._id))\n          localStorage.setItem('user', response.data.nom)\n          localStorage.setItem('login', 'true')\n          console.log('reducer REGISTER: ', localStorage.getItem('login'));\n        })\n        .catch((error) => {\n          console.log(\"erreur be: \", error);\n        });\n      break;\n\n    case 'EDIT_PROFIL':\n      console.log(\"action: \", action.value);\n      axios.put('https://tsiorytahback.herokuapp.com/register/' + localStorage.getItem('id'), action.value)\n        // axios.put(\"http://localhost:8080/register/\" + localStorage.getItem('id'), action.value)\n        .then((response) => {\n          console.log(\"put ok: res.data \", response.data);\n          localStorage.setItem('user', response.data[localStorage.getItem('id')].nom)\n          console.log('reducer EDIT: ', localStorage.getItem('login'));\n        })\n        .catch((error) => {\n          console.log(\"erreur be: \", error);\n        });\n      break;\n\n    case 'DELETE_PROFIL':\n      console.log(\"action: \", action.value);\n      axios.delete('https://tsiorytahback.herokuapp.com/register/' + localStorage.getItem('id'), action.value)\n        // axios.put(\"http://localhost:8080/register/\" + localStorage.getItem('id'), action.value)\n        .then((response) => {\n          console.log(\"delete ok: res.data \", response.data);\n          localStorage.setItem('id', 'none')\n          localStorage.setItem('user', 'none')\n        })\n        .catch((error) => {\n          console.log(\"erreur be: \", error);\n        });\n      break;\n\n    //postLogin 8080\n    case 'LOGIN':\n      console.log(\"action: \", action.value);\n      axios.post('https://tsiorytahback.herokuapp.com/login/', action.value)\n        // axios.post('http://localhost:8080/login', action.value)\n        .then((response) => {\n          if (response.data.nom == action.value.nom) {\n            localStorage.setItem('id', response.data._id)\n            localStorage.setItem('user', response.data.nom)\n            localStorage.setItem('login', 'true')\n            console.log('TSIORY response: ', response.data);\n          }\n          console.log(\"post ok: res.data \", response);\n        })\n        .catch((error) => {\n          console.log(\"erreur be: \", error);\n        });\n      break;\n\n    case 'DECONNECT':\n      localStorage.setItem('id', 'none')\n      localStorage.setItem('user', 'none')\n      localStorage.setItem('login', 'false');\n      break;\n\n\n\n    case 'GETARTICLE':\n      axios.get('https://tsiorytahback.herokuapp.com/profil')\n        // axios.get('http://localhost:8080/')\n        .then(function (response) {\n          nextState = response.data\n          console.log(\"ttt\", nextState);\n          return nextState\n        })\n        .catch(function (error) {\n\n          console.log(error);\n        })\n      break;\n\n\n    case 'UPDATE_ARTICLE':\n      console.log(\"action update: \", action.value);\n      axios.put('https://tsiorytahback.herokuapp.com/profil', action.value)\n        // axios.put('http://localhost:8080/profil/', action.value)\n        .then((response) => {\n          console.log(\"put action: \", action.value);\n          console.log(\"put ok: res.data \", response.data);\n          console.log('reducer PUT: ', localStorage.getItem('login'));\n        })\n        .catch((error) => {\n          console.log(\"put action: \", action.value);\n          console.log(\"erreur be: \", error);\n        });\n      break;\n\n    case 'DELETE_ARTICLE':\n      console.log(\"action: \", action.value);\n      axios.delete('https://tsiorytahback.herokuapp.com/profil/' + action.value._id, action.value)\n        // axios.post('http://localhost:8080/register/', action.value)\n        .then((response) => {\n          console.log(\"delete action: \", action.value);\n          console.log(\"delete ok: res.data \", response.data);\n          console.log('reducer DELETE: ', localStorage.getItem('login'));\n        })\n        .catch((error) => {\n          console.log(\"erreur be: \", error);\n        });\n      break;\n\n    case 'INSCRIRE':\n      console.log(\"action: \", action.value);\n      axios.post('https://tsiorytahback.herokuapp.com/particulier', action.value)\n        // axios.post('http://localhost:8080/particulier/', action.value)\n        .then((response) => {\n          console.log(\"post action: \", action.value);\n          console.log(\"post ok: res.data \", response.data);\n\n          //DEBUT TEST\n          axios.get('https://tsiorytahback.herokuapp.com/profil/')\n            .then(res => {\n              for (let i = 0; i < res.data.length; i++) {\n                if (res.data[i]._id == localStorage.getItem('atelier')) {\n                  this.setState({\n                    _id: res.data[i]._id,\n                    titre: res.data[i].titre,\n                    description: res.data[i].description,\n                    prix: res.data[i].prix,\n                    date: res.data[i].date,\n                    debut: res.data[i].debut,\n                    duree: res.data[i].duree,\n                    reserve: res.data[i].reserve,\n                    disponible: disponible,\n                    image: res.data[i].image,\n                    active: res.data[i].active,\n                    utilisateur: res.data[i].utilisateur,\n                  })\n                }\n              }\n            })\n          const data = new FormData();\n          data.append('image', this.state.image);\n          data.append('titre', this.state.titre);\n          data.append('description', this.state.description);\n          data.append('prix', this.state.prix);\n          data.append('utilisateur', localStorage.getItem('id'))\n          data.append('date', this.state.date);\n          data.append('duree', this.state.duree);\n          data.append('debut', this.state.debut);\n          data.append('reserve', parseInt(this.state.reserve)+1);\n          data.append('disponible', this.state.disponible);\n          data.append('active', true)\n          console.log('local atelier', localStorage.getItem('atelier'));\n\n          fetch('https://tsiorytahback.herokuapp.com/profil/' + localStorage.getItem('atelier'), {\n            // fetch('http://localhost:8080/profil', {\n            method: 'PUT',\n            body: data,\n          }).then((response) => {\n            response.json().then((body) => {\n              console.log('body: ', body);\n\n              this.setState({\n                // image: `http://localhost:8080/profil/${body.image}`,\n                image: `https://tsiorytahback.herokuapp.com/profil/${body.titre}` + localStorage.getItem('atelier') + '.jpg',\n              });\n            });\n          });\n\n          //FIN TEST\n\n        })\n        .catch((error) => {\n          console.log(\"erreur be: \", error);\n        });\n      break;\n\n    default:\n      return state\n  }\n}\n\nexport default connexion\n"]},"metadata":{},"sourceType":"module"}